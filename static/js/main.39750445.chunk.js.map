{"version":3,"sources":["components/Main/index.tsx","Aviasales/components/Filter/constants.ts","Aviasales/components/Filter/index.tsx","Aviasales/utils/filtering.ts","Aviasales/constants.ts","Aviasales/utils/index.ts","Aviasales/components/Card/Information/index.tsx","Aviasales/components/Card/index.tsx","Aviasales/components/List/index.tsx","Aviasales/components/Header/index.tsx","Aviasales/components/Button/index.tsx","Aviasales/query/index.ts","Aviasales/index.tsx","App.tsx","serviceWorker.js","index.tsx"],"names":["Title","Typography","Main","className","to","STOPS","Group","Checkbox","Filter","props","useState","checkAll","setCheckAll","items","checkedList","setCheckedList","onChange","useCallback","list","length","clickFilterHandler","countStops","listStops","Object","entries","stop","key","value","includes","push","searchStops","onCheckAllChange","event","target","checked","level","title","options","SORT","TABS","FILTERS","values","sumDurationStops","ticket","reduce","acc","item","duration","filteringTickets","tickets","parameter","stops","sort","a","b","price","segments","filter","from","filterOfTransfers","range","date","milisecondStartDate","Date","parse","milisecondDuration","dtStart","dtFinish","getHours","getMinutes","formatTime","days","hours","Math","floor","minutes","ceil","stopsCount","count","message","toUpperCase","Information","origin","destination","join","Card","src","carrier","alt","map","List","random","HeaderMain","italic","mark","ButtonMain","type","size","onClick","onClickHandler","label","getSearchId","fetch","data","json","response","getTickets","searchId","status","Error","console","log","Text","TabPane","Tabs","Aviasales","setSearchId","ticketsAll","setTicketsAll","endSearchTickets","setEndSearchTickets","firstPackTickets","setFirstPackTickets","defaultFilter","setDefaultFilter","viewTickets","sortTickets","setSortTickets","keys","setStops","useEffect","then","catch","warning","get","slice","splice","onLoadTickets","onBack","window","history","back","Header","defaultActiveKey","tab","direction","description","Button","Content","Layout","App","path","component","MainPage","exact","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","error"],"mappings":"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","file":"static/js/main.39750445.chunk.js","sourcesContent":["import { Typography } from \"antd\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport \"./style.scss\";\r\n\r\nconst { Title } = Typography;\r\n\r\nconst Main = () => (\r\n  <section className=\"main\">\r\n    <Title>Hello World!</Title>\r\n    <Link to=\"/aviasales\">Поикс дешёвых авиабилетов</Link>\r\n  </section>\r\n);\r\n\r\nexport default Main;\r\n","export const STOPS: Array<string> = [\"Без пересадок\", \"1 пересадка\", \"2 пересадки\", \"3 пересадки\"];","import { Typography, Checkbox } from \"antd\";\r\nimport { FC, useState, useCallback } from \"react\";\r\n\r\nimport { searchStops } from \"../../utils/filtering\";\r\n\r\nimport IFilter from \"./index.interface\";\r\n\r\nimport \"./style.scss\";\r\n\r\nconst { Title } = Typography;\r\nconst { Group } = Checkbox;\r\n\r\nconst Filter: FC<IFilter> = (props) => {\r\n  const [checkAll, setCheckAll] = useState<boolean>(true);\r\n  const [checkedList, setCheckedList] = useState<Array<string>>(checkAll ? props.items : []);\r\n\r\n  const onChange = useCallback((list) => {\r\n    setCheckedList(list);\r\n    setCheckAll(list.length === props.items.length);\r\n\r\n    props.clickFilterHandler(searchStops(list));\r\n  }, []);\r\n\r\n  const onCheckAllChange = useCallback((event) => {\r\n    setCheckedList(event.target.checked ? props.items : []);\r\n    setCheckAll(event.target.checked);\r\n    props.clickFilterHandler(event.target.checked ? props.items : []);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"filter\">\r\n      <Title level={5}>{ props.title }</Title>\r\n      <Checkbox checked={checkAll} onChange={onCheckAllChange}>Все</Checkbox>\r\n      <Group options={props.items} value={checkedList} onChange={onChange} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Filter;\r\n","import { STOPS } from \"../components/Filter/constants\";\r\n\r\nimport ICard from \"../components/Card/index.interface\";\r\n\r\nexport const searchStops = (countStops: Array<string>): Array<string> => {\r\n  const listStops = [];\r\n\r\n  for (let stop of Object.entries(STOPS)) {\r\n    const [key, value] = stop;\r\n\r\n    if (countStops.includes(value)) {\r\n      listStops.push(key);\r\n    }\r\n  }\r\n\r\n  return listStops;\r\n};\r\n\r\nexport const filterOfTransfers = (tickets: Array<ICard>, stops: Array<string>): Array<ICard> => {\r\n  if (stops.length === 0) {\r\n    return [];\r\n  } else if (stops.length === STOPS.length) {\r\n    return tickets;\r\n  } else {\r\n    return tickets.filter((item) => {\r\n      const [ from, to ] = item.segments;\r\n  \r\n      return stops.includes(`${from.stops.length}`) || stops.includes(`${to.stops.length}`)\r\n    });\r\n  }\r\n};\r\n","interface ISort {\r\n  CHEAP: string;\r\n  FAST: string;\r\n};\r\n\r\nexport const SORT: ISort = {\r\n  CHEAP: \"1\",\r\n  FAST: \"2\",\r\n};\r\n\r\ninterface ITabs {\r\n  key: string;\r\n  title: string;\r\n};\r\n\r\nexport const TABS: Array<ITabs> = [\r\n  {\r\n    key: \"1\",\r\n    title: \"Самый дешевый\",\r\n  },\r\n  {\r\n    key: \"2\",\r\n    title: \"Самый быстрый\",\r\n  },\r\n];\r\n\r\nexport const STOPS = {\r\n  0: \"Без пересадок\",\r\n  1: \"1 пересадка\",\r\n  2: \"2 пересадки\",\r\n  3: \"3 пересадки\"\r\n};\r\n\r\nexport const LIMIT: number = 5;\r\n\r\ninterface IFilters {\r\n  title: string;\r\n  items: Array<string>;\r\n};\r\n\r\nexport const FILTERS: Array<IFilters> = [\r\n  {\r\n    title: \"Количество пересадок\",\r\n    items: Object.values(STOPS),\r\n  }\r\n]\r\n","import { SORT } from \"../constants\";\r\nimport { filterOfTransfers } from \"./filtering\";\r\n\r\nimport ICard from \"../components/Card/index.interface\";\r\n\r\nimport { IInformation } from \"../components/Card/Information/index.interface\";\r\n\r\nconst sumDurationStops = (ticket: Array<IInformation>) => ticket.reduce((acc, item) => acc + item.duration, 0);\r\n\r\nexport const filteringTickets = (tickets: Array<ICard>, parameter: string, stops: Array<string>) => {\r\n  let list: Array<ICard> = [];\r\n\r\n  if (parameter === SORT.CHEAP) {\r\n    list= tickets.sort((a, b) => a.price - b.price)\r\n  } else if (parameter === SORT.FAST) {\r\n    list = tickets.sort((a, b) => sumDurationStops(a.segments) - sumDurationStops(b.segments));\r\n  }\r\n\r\n  list= filterOfTransfers(list, stops);\r\n\r\n  return list;\r\n};\r\n\r\nexport const range = (date: string, duration: number): string => {\r\n  const MINUTE = 60;\r\n  const MILISECOND = 1000;\r\n\r\n  const milisecondStartDate = Date.parse(date);\r\n  const milisecondDuration = duration * MINUTE * MILISECOND;\r\n\r\n  const dtStart = new Date(date);\r\n  const dtFinish = new Date(milisecondStartDate + milisecondDuration);\r\n\r\n  return `${dtStart.getHours()}:${dtStart.getMinutes()} - ${dtFinish.getHours()}:${dtFinish.getMinutes()}`;\r\n};\r\n\r\nexport const formatTime = (duration: number): string => {\r\n  const ONE_DAY: number = 24;\r\n  const ONE_HOUR: number = 60;\r\n\r\n  let days: number = 0;\r\n  let hours: number = Math.floor(duration / ONE_HOUR);\r\n  let minutes: number | string = duration % ONE_HOUR;\r\n\r\n  if (hours > ONE_DAY) {\r\n    days = Math.ceil(hours / ONE_DAY);\r\n    hours = hours % ONE_DAY;\r\n  }\r\n\r\n  minutes = minutes < 10 ? `0${minutes}` : minutes;\r\n\r\n  return days > 0 ? `${days}Д ${hours}Ч ${minutes}М` : `${hours}Ч ${minutes}М`;\r\n};\r\n\r\nexport const stopsCount = (count: number): string => {\r\n  let message = \"\";\r\n\r\n  if (count === 0) {\r\n    message = \"Без пересадок\";\r\n  } else if (count === 1) {\r\n    message = `${count} пересадка`;\r\n  } else if (count >= 2 && count < 5) {\r\n    message = `${count} пересадки`;\r\n  } else if (count >= 5) {\r\n    message = `${count} пересадок`;\r\n  }\r\n\r\n  return message.toUpperCase();\r\n}\r\n","import { FC } from \"react\";\r\n\r\nimport { formatTime, range, stopsCount } from \"../../../utils\";\r\n\r\nimport { IInformation } from \"./index.interface\";\r\n\r\nimport \"./style.scss\";\r\n\r\nconst Information: FC<IInformation>  = (props) => (\r\n  <div className=\"information\">\r\n    <div className=\"information__route\">\r\n      <div className=\"information__title\">\r\n        {props.origin}-{props.destination}\r\n      </div>\r\n      <div className=\"information__description\">{range(props.date, props.duration)}</div>\r\n    </div>\r\n    <div className=\"information__length\">\r\n      <div className=\"information__title\">В ПУТИ</div>\r\n      <div className=\"information__description\">{formatTime(props.duration)}</div>\r\n    </div>\r\n    <div className=\"information__stop\">\r\n      <div className=\"information__title\">{stopsCount(props.stops.length)}</div>\r\n      <div className=\"information__description\">{props.stops.join(\", \")}</div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default Information;\r\n","import { FC } from \"react\";\r\n\r\nimport Information from \"./Information\";\r\n\r\nimport ICard from \"./index.interface\";\r\n\r\nimport \"./style.scss\";\r\n\r\nconst Card: FC<ICard> = (props) => (\r\n  <div className=\"card\">\r\n    <header className=\"card__header\">\r\n      <div className=\"card__price\">{props.price} Р</div>\r\n      <img\r\n        src={`https://pics.avs.io/99/36/${props.carrier}.png`}\r\n        alt={props.carrier}\r\n      />\r\n    </header>\r\n    {props.segments.map((item) => <Information {...item} key={item.duration} />)}\r\n  </div>\r\n);\r\n\r\nexport default Card;\r\n","import { FC } from \"react\";\r\n\r\nimport Card from \"../Card\";\r\n\r\nimport IList from \"./index.interface\";\r\n\r\nimport \"./style.scss\";\r\n\r\nconst List: FC<IList> = (props) => (\r\n  <div className=\"aviasales-list-tickets\">\r\n    {props.tickets.map((ticket) => (\r\n      <Card {...ticket} key={`${ticket.price + Math.random()}-${ticket.carrier}`} />\r\n    ))}\r\n  </div>\r\n);\r\n\r\nexport default List;\r\n","import { Typography } from \"antd\";\r\n\r\nconst { Title } = Typography;\r\n\r\nconst HeaderMain = () => (\r\n    <header className=\"aviasales-header\">\r\n        <Title italic={true} mark={true}>Aviasales</Title>\r\n    </header>\r\n);\r\n\r\nexport default HeaderMain;\r\n","import { FC } from \"react\";\r\nimport { Button } from \"antd\";\r\n\r\nimport { IButton } from \"./index.interface\";\r\n\r\nconst ButtonMain: FC<IButton> = (props) => {\r\n  return (\r\n    <Button type={props.type} size={props.size} onClick={props.onClickHandler}>\r\n      {props.label}\r\n    </Button>\r\n  );\r\n};\r\n\r\nexport default ButtonMain;\r\n","import { IResponseTickets, ISearchId } from \"../index.interface\";\r\n\r\nconst PATH_GET_SEARCH_ID = \"https://front-test.beta.aviasales.ru/search\";\r\nconst PATH_GET_TICKETS = \"https://front-test.beta.aviasales.ru/tickets\";\r\n\r\nexport const getSearchId = async () => {\r\n  const data = await fetch(PATH_GET_SEARCH_ID);\r\n  const response: ISearchId = await data.json();\r\n\r\n  return response;\r\n};\r\n\r\nexport const getTickets = async (searchId: string) => {\r\n  let status: boolean = true;\r\n\r\n  while (status) {\r\n    try {\r\n      const data = await fetch(`${PATH_GET_TICKETS}?searchId=${searchId}`);\r\n  \r\n      if (data.status >= 200 && data.status <= 299) {\r\n        const response: IResponseTickets = await data.json();\r\n        return response;\r\n      } else {\r\n        status = false;\r\n        throw new Error(\"Что-то пошло не так\");\r\n      }\r\n    } catch (error) {\r\n      status = true;\r\n      console.log(\"---data\", error);\r\n    }\r\n  }\r\n};\r\n","import { useState, useEffect } from \"react\";\r\nimport { message, Spin, Tabs, Empty, Typography, Space, PageHeader } from \"antd\";\r\nimport { get } from \"lodash\";\r\n\r\nimport Filter from \"./components/Filter\";\r\nimport List from \"./components/List\";\r\nimport HeaderMain from \"./components/Header\";\r\nimport ButtonMain from \"./components/Button\";\r\n\r\nimport { getSearchId, getTickets } from \"./query\";\r\nimport { filteringTickets } from \"./utils\";\r\n\r\nimport \"./style.scss\";\r\n\r\nimport { SORT, TABS, STOPS, LIMIT, FILTERS } from \"./constants\";\r\n\r\nimport ICard from \"./components/Card/index.interface\";\r\nimport { ITickets } from \"./index.interface\";\r\n\r\nconst { Text } = Typography;\r\nconst { TabPane } = Tabs;\r\n\r\nconst Aviasales = () => {\r\n  const [searchId, setSearchId] = useState<string>(\"\");\r\n  const [ticketsAll, setTicketsAll] = useState<Array<ICard>>([]);\r\n  const [endSearchTickets, setEndSearchTickets] = useState<boolean>(false);\r\n  const [firstPackTickets, setFirstPackTickets] = useState<boolean>(true);\r\n\r\n  const [defaultFilter, setDefaultFilter] = useState<string>(SORT.CHEAP);\r\n  const [sortTickets, setSortTickets] = useState<ITickets>({\r\n    tickets: [],\r\n    viewTickets: []\r\n  });\r\n  const [stops, setStops] = useState<Array<string>>(Object.keys(STOPS));\r\n\r\n  useEffect(() => {\r\n    getSearchId()\r\n      .then((response) => setSearchId(response.searchId))\r\n      .catch(() =>\r\n        message.warning(\"Что-то пошло не так, перезагрузите страницу\")\r\n      );\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (searchId === \"\") {\r\n      return;\r\n    }\r\n\r\n    if (!endSearchTickets) {\r\n      getTickets(searchId)\r\n        .then((response) => {\r\n          setEndSearchTickets(get(response, \"stop\", false));\r\n          setTicketsAll([...ticketsAll, ...get(response, \"tickets\", [])]);\r\n        \r\n          if (firstPackTickets) {\r\n            const list = filteringTickets(ticketsAll, defaultFilter, stops);\r\n\r\n            setSortTickets({\r\n              tickets: list,\r\n              viewTickets: list.slice().splice(0, LIMIT)\r\n            });\r\n          }\r\n\r\n          setFirstPackTickets(false);\r\n        });\r\n    }\r\n  }, [endSearchTickets, searchId, ticketsAll]);\r\n\r\n  useEffect(() => {\r\n    if (endSearchTickets) {\r\n      const list = filteringTickets(ticketsAll, defaultFilter, stops);\r\n\r\n      setSortTickets({\r\n        tickets: list,\r\n        viewTickets: list.slice().splice(0, LIMIT)\r\n      });\r\n    }\r\n  }, [ endSearchTickets, ticketsAll, defaultFilter, stops ]);\r\n\r\n  const onChangeTabs = (key: string): void => {\r\n    const list = filteringTickets(ticketsAll, key, stops);\r\n    setDefaultFilter(key);\r\n\r\n    setSortTickets(() => ({\r\n      tickets: list,\r\n      viewTickets: list.slice().splice(0, LIMIT)\r\n    }));\r\n  };\r\n\r\n  const onLoadTickets = (): void => {\r\n    setSortTickets({\r\n      tickets: sortTickets.tickets,\r\n      viewTickets: [ ...sortTickets.viewTickets, ...sortTickets.tickets.slice().splice(sortTickets.viewTickets.length, LIMIT) ]\r\n    });\r\n  }\r\n\r\n  return (\r\n    <section className=\"aviasales\">\r\n      <PageHeader title=\"Back\" onBack={() => window.history.back()} />\r\n      <HeaderMain />\r\n      <div className=\"aviasales__wrapper\">\r\n        <aside className=\"aviasales__filters\">\r\n          { FILTERS.map((item) => <Filter title={item.title} items={item.items} clickFilterHandler={setStops} />) }\r\n        </aside>\r\n        <div className=\"aviasales__content\">  \r\n          <Tabs defaultActiveKey={defaultFilter} onChange={onChangeTabs}>\r\n            {TABS.map((tab) => (\r\n              <TabPane tab={tab.title} key={tab.key}>\r\n                <Space direction=\"vertical\">\r\n                  <Text>{`Мы нашли ${ticketsAll.length} билетов`}</Text>\r\n                  <Text>{`Мы нашли ${sortTickets.tickets.length} билетов по выбраным фильтрам`}</Text>\r\n                  <Text>{`Показано ${sortTickets.viewTickets.length} из ${sortTickets.tickets.length} билетов`}</Text>\r\n                  { !endSearchTickets && <Spin />  }\r\n                </Space>\r\n                { stops.length === 0 && <Empty description={`Мы нашли ${sortTickets.tickets.length} билетов по выбраным фильтрам`} /> }\r\n                { sortTickets.tickets.length > 0 && (\r\n                  <>\r\n                    <List tickets={sortTickets.viewTickets} />\r\n                    <ButtonMain type=\"primary\" size=\"large\" onClickHandler={onLoadTickets} label={`Показать ещё ${LIMIT} билетов`} />\r\n                  </>\r\n                  )\r\n                }\r\n              </TabPane>\r\n            ))}\r\n          </Tabs>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Aviasales;\r\n","import { HashRouter as Router, Route } from \"react-router-dom\";\r\nimport { Layout } from \"antd\";\r\n\r\nimport MainPage from \"./components/Main\";\r\nimport Aviasales from \"./Aviasales\";\r\n\r\nconst { Content } = Layout;\r\n\r\nconst App = () => (\r\n  <Router>\r\n    <Content>\r\n      <Route path=\"/\" component={MainPage} exact />\r\n      <Route path=\"/aviasales\" component={Aviasales} exact />\r\n    </Content>\r\n  </Router>\r\n);\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import ReactDOM from 'react-dom';\r\nimport { HashRouter } from \"react-router-dom\";\r\nimport { Layout } from \"antd\";\r\n\r\n\r\nimport \"antd/dist/antd.css\";\r\n\r\nimport './index.scss';\r\n\r\nimport App from './App';\r\n\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  <HashRouter>\r\n    <Layout>\r\n      <App />\r\n    </Layout>\r\n  </HashRouter>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}