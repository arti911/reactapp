"use strict";(self.webpackChunkreactapp=self.webpackChunkreactapp||[]).push([[892],{1892:function(e,t,n){n.r(t),n.d(t,{default:function(){return q}});var c=n(3433),s=n(9439),i=n(390),r=n(549),a=n(7264),l=n(285),o=n(7053),u=n(2692),d=n(4948),h=n(3241),f=n(7262),v=n(47),p=["\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a","1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430","2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438","3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"],k=n(2559),m=r.Z.Title,x=v.Z.Group,j=function(e){var t=(0,i.useState)(!0),n=(0,s.Z)(t,2),c=n[0],r=n[1],a=(0,i.useState)(c?e.items:[]),l=(0,s.Z)(a,2),o=l[0],u=l[1],d=(0,i.useCallback)((function(t){u(t),r(t.length===e.items.length),e.clickFilterHandler(function(e){for(var t=[],n=0,c=Object.entries(p);n<c.length;n++){var i=c[n],r=(0,s.Z)(i,2),a=r[0],l=r[1];e.includes(l)&&t.push(a)}return t}(t))}),[]),h=(0,i.useCallback)((function(t){u(t.target.checked?e.items:[]),r(t.target.checked),e.clickFilterHandler(t.target.checked?e.items:[])}),[]);return(0,k.jsxs)("div",{className:"filter",children:[(0,k.jsx)(m,{level:5,children:e.title}),(0,k.jsx)(v.Z,{checked:c,onChange:h,children:"\u0412\u0441\u0435"}),(0,k.jsx)(x,{options:e.items,value:o,onChange:d})]})},g=n(1413),Z="1",_="2",w=[{key:"1",title:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439"},{key:"2",title:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439"}],b={0:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",1:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",2:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",3:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"},N=[{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",items:Object.values(b)}],y=function(e){return e.reduce((function(e,t){return e+t.duration}),0)},T=function(e,t,n){var c=[];return t===Z?c=e.sort((function(e,t){return e.price-t.price})):t===_&&(c=e.sort((function(e,t){return y(e.segments)-y(t.segments)}))),c=function(e,t){return 0===t.length?[]:t.length===p.length?e:e.filter((function(e){var n=(0,s.Z)(e.segments,2),c=n[0],i=n[1];return t.includes("".concat(null===c||void 0===c?void 0:c.stops.length))||t.includes("".concat(null===i||void 0===i?void 0:i.stops.length))}))}(c,n),c},C=function(e,t){var n=Date.parse(e),c=60*t*1e3,s=new Date(e),i=new Date(n+c);return"".concat(s.getHours(),":").concat(s.getMinutes()," - ").concat(i.getHours(),":").concat(i.getMinutes())},S=function(e){var t=0,n=Math.floor(e/60),c=e%60;return n>24&&(t=Math.ceil(n/24),n%=24),c=c<10?"0".concat(c):c,t>0?"".concat(t,"\u0414 ").concat(n,"\u0427 ").concat(c,"\u041c"):"".concat(n,"\u0427 ").concat(c,"\u041c")},H=function(e){var t="";return 0===e?t="\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a":1===e?t="".concat(e," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430"):e>=2&&e<5?t="".concat(e," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"):e>=5&&(t="".concat(e," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a")),t.toUpperCase()},E=function(e){return(0,k.jsxs)("div",{className:"information",children:[(0,k.jsxs)("div",{className:"information__route",children:[(0,k.jsxs)("div",{className:"information__title",children:[e.origin,"-",e.destination]}),(0,k.jsx)("div",{className:"information__description",children:C(e.date,e.duration)})]}),(0,k.jsxs)("div",{className:"information__length",children:[(0,k.jsx)("div",{className:"information__title",children:"\u0412 \u041f\u0423\u0422\u0418"}),(0,k.jsx)("div",{className:"information__description",children:S(e.duration)})]}),(0,k.jsxs)("div",{className:"information__stop",children:[(0,k.jsx)("div",{className:"information__title",children:H(e.stops.length)}),(0,k.jsx)("div",{className:"information__description",children:e.stops.join(", ")})]})]})},M=function(e){return(0,k.jsxs)("div",{className:"card",children:[(0,k.jsxs)("header",{className:"card__header",children:[(0,k.jsxs)("div",{className:"card__price",children:[e.price," \u0420"]}),(0,k.jsx)("img",{src:"https://pics.avs.io/99/36/".concat(e.carrier,".png"),alt:e.carrier})]}),e.segments.map((function(e){return(0,i.createElement)(E,(0,g.Z)((0,g.Z)({},e),{},{key:e.duration}))}))]})},F=function(e){return(0,k.jsx)("div",{className:"aviasales-list-tickets",children:e.tickets.map((function(e){return(0,i.createElement)(M,(0,g.Z)((0,g.Z)({},e),{},{key:"".concat(e.price+Math.random(),"-").concat(e.carrier)}))}))})},z=r.Z.Title,D=function(){return(0,k.jsx)("header",{className:"aviasales-header",children:(0,k.jsx)(z,{italic:!0,mark:!0,children:"Aviasales"})})},O=n(140),A=function(e){return(0,k.jsx)(O.Z,{type:e.type,size:e.size,onClick:e.onClickHandler,children:e.label})},B=n(4165),I=n(5861),P=function(){var e=(0,I.Z)((0,B.Z)().mark((function e(){var t,n;return(0,B.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://front-test.beta.aviasales.ru/search");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=(0,I.Z)((0,B.Z)().mark((function e(t){var n,c,s;return(0,B.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!0;case 1:if(!n){e.next=23;break}return e.prev=2,e.next=5,fetch("".concat("https://front-test.beta.aviasales.ru/tickets","?searchId=").concat(t));case 5:if(!((c=e.sent).status>=200&&c.status<=299)){e.next=13;break}return e.next=9,c.json();case 9:return s=e.sent,e.abrupt("return",s);case 13:throw n=!1,new Error("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a");case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),n=!0,console.log("---data",e.t0);case 21:e.next=1;break;case 23:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}(),K=r.Z.Text,U=a.Z.TabPane,q=function(){var e=(0,i.useState)(""),t=(0,s.Z)(e,2),n=t[0],r=t[1],v=(0,i.useState)([]),p=(0,s.Z)(v,2),m=p[0],x=p[1],g=(0,i.useState)(!1),_=(0,s.Z)(g,2),y=_[0],C=_[1],S=(0,i.useState)(!0),H=(0,s.Z)(S,2),E=H[0],M=H[1],z=(0,i.useState)(Z),O=(0,s.Z)(z,2),B=O[0],I=O[1],q=(0,i.useState)({tickets:[],viewTickets:[]}),J=(0,s.Z)(q,2),L=J[0],Q=J[1],R=(0,i.useState)(Object.keys(b)),V=(0,s.Z)(R,2),W=V[0],X=V[1];(0,i.useEffect)((function(){P().then((function(e){return r(e.searchId)})).catch((function(){return l.ZP.warning("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a, \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443")}))}),[]),(0,i.useEffect)((function(){""!==n&&(y||G(n).then((function(e){if(C((0,f.get)(e,"stop",!1)),x([].concat((0,c.Z)(m),(0,c.Z)((0,f.get)(e,"tickets",[])))),E){var t=T(m,B,W);Q({tickets:t,viewTickets:t.slice().splice(0,5)})}M(!1)})))}),[y,n,m]),(0,i.useEffect)((function(){if(y){var e=T(m,B,W);Q({tickets:e,viewTickets:e.slice().splice(0,5)})}}),[y,m,B,W]);var Y=function(){Q({tickets:L.tickets,viewTickets:[].concat((0,c.Z)(L.viewTickets),(0,c.Z)(L.tickets.slice().splice(L.viewTickets.length,5)))})};return(0,k.jsxs)("section",{className:"aviasales",children:[(0,k.jsx)(o.Z,{title:"Back",onBack:function(){return window.history.back()}}),(0,k.jsx)(D,{}),(0,k.jsxs)("div",{className:"aviasales__wrapper",children:[(0,k.jsx)("aside",{className:"aviasales__filters",children:N.map((function(e){return(0,k.jsx)(j,{title:e.title,items:e.items,clickFilterHandler:X})}))}),(0,k.jsx)("div",{className:"aviasales__content",children:(0,k.jsx)(a.Z,{defaultActiveKey:B,onChange:function(e){var t=T(m,e,W);I(e),Q((function(){return{tickets:t,viewTickets:t.slice().splice(0,5)}}))},children:w.map((function(e){return(0,k.jsxs)(U,{tab:e.title,children:[(0,k.jsxs)(u.Z,{direction:"vertical",children:[(0,k.jsx)(K,{children:"\u041c\u044b \u043d\u0430\u0448\u043b\u0438 ".concat(m.length," \u0431\u0438\u043b\u0435\u0442\u043e\u0432")}),(0,k.jsx)(K,{children:"\u041c\u044b \u043d\u0430\u0448\u043b\u0438 ".concat(L.tickets.length," \u0431\u0438\u043b\u0435\u0442\u043e\u0432 \u043f\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u044b\u043c \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u043c")}),(0,k.jsx)(K,{children:"\u041f\u043e\u043a\u0430\u0437\u0430\u043d\u043e ".concat(L.viewTickets.length," \u0438\u0437 ").concat(L.tickets.length," \u0431\u0438\u043b\u0435\u0442\u043e\u0432")}),!y&&(0,k.jsx)(d.Z,{})]}),0===W.length&&(0,k.jsx)(h.Z,{description:"\u041c\u044b \u043d\u0430\u0448\u043b\u0438 ".concat(L.tickets.length," \u0431\u0438\u043b\u0435\u0442\u043e\u0432 \u043f\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u044b\u043c \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u043c")}),L.tickets.length>0&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(F,{tickets:L.viewTickets}),(0,k.jsx)(A,{type:"primary",size:"large",onClickHandler:Y,label:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451 ".concat(5," \u0431\u0438\u043b\u0435\u0442\u043e\u0432")})]})]},e.key)}))})})]})]})}}}]);
//# sourceMappingURL=892.e8011648.chunk.js.map