{"version":3,"file":"static/js/892.e8011648.chunk.js","mappings":"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","sources":["pages/Aviasales/components/Filter/constants.ts","pages/Aviasales/components/Filter/index.tsx","pages/Aviasales/utils/filtering.ts","pages/Aviasales/constants.ts","pages/Aviasales/utils/index.ts","pages/Aviasales/components/Card/Information/index.tsx","pages/Aviasales/components/Card/index.tsx","pages/Aviasales/components/List/index.tsx","pages/Aviasales/components/Header/index.tsx","pages/Aviasales/components/Button/index.tsx","pages/Aviasales/query/index.ts","pages/Aviasales/index.tsx"],"sourcesContent":["export const STOPS: Array<string> = [\"Без пересадок\", \"1 пересадка\", \"2 пересадки\", \"3 пересадки\"];","import { Typography, Checkbox } from \"antd\";\r\nimport React, { useState, useCallback } from \"react\";\r\n\r\nimport { searchStops } from \"../../utils/filtering\";\r\n\r\nimport IFilter from \"./index.interface\";\r\n\r\nimport \"./style.scss\";\r\n\r\nconst { Title } = Typography;\r\nconst { Group } = Checkbox;\r\n\r\nconst Filter = (props: IFilter) => {\r\n  const [checkAll, setCheckAll] = useState<boolean>(true);\r\n  const [checkedList, setCheckedList] = useState<Array<string>>(checkAll ? props.items : []);\r\n\r\n  const onChange = useCallback((list: any) => {\r\n    setCheckedList(list);\r\n    setCheckAll(list.length === props.items.length);\r\n\r\n    props.clickFilterHandler(searchStops(list));\r\n  }, []);\r\n\r\n  const onCheckAllChange = useCallback((event: any) => {\r\n    setCheckedList(event.target.checked ? props.items : []);\r\n    setCheckAll(event.target.checked);\r\n    props.clickFilterHandler(event.target.checked ? props.items : []);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"filter\">\r\n      <Title level={5}>{ props.title }</Title>\r\n      <Checkbox checked={checkAll} onChange={onCheckAllChange}>Все</Checkbox>\r\n      <Group options={props.items} value={checkedList} onChange={onChange} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Filter;\r\n","import { STOPS } from \"../components/Filter/constants\";\r\n\r\nimport ICard from \"../components/Card/index.interface\";\r\n\r\nexport const searchStops = (countStops: Array<string>): Array<string> => {\r\n  const listStops: Array<string> = [];\r\n\r\n  for (let stop of Object.entries(STOPS)) {\r\n    const [key, value] = stop;\r\n\r\n    if (countStops.includes(value)) {\r\n      listStops.push(key);\r\n    }\r\n  }\r\n\r\n  return listStops;\r\n};\r\n\r\nexport const filterOfTransfers = (tickets: ICard[], stops: string[]): ICard[] => {\r\n  if (stops.length === 0) {\r\n    return [];\r\n  } else if (stops.length === STOPS.length) {\r\n    return tickets;\r\n  } else {\r\n    return tickets.filter((item) => {\r\n      const [ from, to ] = item.segments;\r\n  \r\n      return stops.includes(`${from?.stops.length}`) || stops.includes(`${to?.stops.length}`)\r\n    });\r\n  }\r\n};\r\n","interface ISort {\r\n  CHEAP: string;\r\n  FAST: string;\r\n};\r\n\r\nexport const SORT: ISort = {\r\n  CHEAP: \"1\",\r\n  FAST: \"2\",\r\n};\r\n\r\ninterface ITabs {\r\n  key: string;\r\n  title: string;\r\n};\r\n\r\nexport const TABS: Array<ITabs> = [\r\n  {\r\n    key: \"1\",\r\n    title: \"Самый дешевый\",\r\n  },\r\n  {\r\n    key: \"2\",\r\n    title: \"Самый быстрый\",\r\n  },\r\n];\r\n\r\nexport const STOPS = {\r\n  0: \"Без пересадок\",\r\n  1: \"1 пересадка\",\r\n  2: \"2 пересадки\",\r\n  3: \"3 пересадки\"\r\n};\r\n\r\nexport const LIMIT: number = 5;\r\n\r\ninterface IFilters {\r\n  title: string;\r\n  items: Array<string>;\r\n};\r\n\r\nexport const FILTERS: Array<IFilters> = [\r\n  {\r\n    title: \"Количество пересадок\",\r\n    items: Object.values(STOPS),\r\n  }\r\n]\r\n","import { SORT } from \"../constants\";\r\nimport { filterOfTransfers } from \"./filtering\";\r\n\r\nimport ICard from \"../components/Card/index.interface\";\r\n\r\nimport { IInformation } from \"../components/Card/Information/index.interface\";\r\n\r\nconst sumDurationStops = (ticket: Array<IInformation>) => ticket.reduce((acc, item) => acc + item.duration, 0);\r\n\r\nexport const filteringTickets = (tickets: Array<ICard>, parameter: string, stops: Array<string>) => {\r\n  let list: Array<ICard> = [];\r\n\r\n  if (parameter === SORT.CHEAP) {\r\n    list= tickets.sort((a, b) => a.price - b.price)\r\n  } else if (parameter === SORT.FAST) {\r\n    list = tickets.sort((a, b) => sumDurationStops(a.segments) - sumDurationStops(b.segments));\r\n  }\r\n\r\n  list= filterOfTransfers(list, stops);\r\n\r\n  return list;\r\n};\r\n\r\nexport const range = (date: string, duration: number): string => {\r\n  const MINUTE: number = 60;\r\n  const MILISECOND: number = 1000;\r\n\r\n  const milisecondStartDate: number = Date.parse(date);\r\n  const milisecondDuration: number = duration * MINUTE * MILISECOND;\r\n\r\n  const dtStart: Date = new Date(date);\r\n  const dtFinish: Date = new Date(milisecondStartDate + milisecondDuration);\r\n\r\n  return `${dtStart.getHours()}:${dtStart.getMinutes()} - ${dtFinish.getHours()}:${dtFinish.getMinutes()}`;\r\n};\r\n\r\nexport const formatTime = (duration: number): string => {\r\n  const ONE_DAY: number = 24;\r\n  const ONE_HOUR: number = 60;\r\n\r\n  let days: number = 0;\r\n  let hours: number = Math.floor(duration / ONE_HOUR);\r\n  let minutes: number | string = duration % ONE_HOUR;\r\n\r\n  if (hours > ONE_DAY) {\r\n    days = Math.ceil(hours / ONE_DAY);\r\n    hours = hours % ONE_DAY;\r\n  }\r\n\r\n  minutes = minutes < 10 ? `0${minutes}` : minutes;\r\n\r\n  return days > 0 ? `${days}Д ${hours}Ч ${minutes}М` : `${hours}Ч ${minutes}М`;\r\n};\r\n\r\nexport const stopsCount = (count: number): string => {\r\n  let message = \"\";\r\n\r\n  if (count === 0) {\r\n    message = \"Без пересадок\";\r\n  } else if (count === 1) {\r\n    message = `${count} пересадка`;\r\n  } else if (count >= 2 && count < 5) {\r\n    message = `${count} пересадки`;\r\n  } else if (count >= 5) {\r\n    message = `${count} пересадок`;\r\n  }\r\n\r\n  return message.toUpperCase();\r\n}\r\n","import React from \"react\";\r\n\r\nimport { formatTime, range, stopsCount } from \"../../../utils\";\r\n\r\nimport { IInformation } from \"./index.interface\";\r\n\r\nimport \"./style.scss\";\r\n\r\nconst Information = (props: IInformation) => (\r\n  <div className=\"information\">\r\n    <div className=\"information__route\">\r\n      <div className=\"information__title\">\r\n        {props.origin}-{props.destination}\r\n      </div>\r\n      <div className=\"information__description\">{range(props.date, props.duration)}</div>\r\n    </div>\r\n    <div className=\"information__length\">\r\n      <div className=\"information__title\">В ПУТИ</div>\r\n      <div className=\"information__description\">{formatTime(props.duration)}</div>\r\n    </div>\r\n    <div className=\"information__stop\">\r\n      <div className=\"information__title\">{stopsCount(props.stops.length)}</div>\r\n      <div className=\"information__description\">{props.stops.join(\", \")}</div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default Information;\r\n","import React from \"react\";\r\n\r\nimport Information from \"./Information\";\r\n\r\nimport ICard from \"./index.interface\";\r\n\r\nimport \"./style.scss\";\r\n\r\nconst Card = (props: ICard) => (\r\n  <div className=\"card\">\r\n    <header className=\"card__header\">\r\n      <div className=\"card__price\">{props.price} Р</div>\r\n      <img\r\n        src={`https://pics.avs.io/99/36/${props.carrier}.png`}\r\n        alt={props.carrier}\r\n      />\r\n    </header>\r\n    {props.segments.map((item) => <Information {...item} key={item.duration} />)}\r\n  </div>\r\n);\r\n\r\nexport default Card;\r\n","import React from \"react\";\r\n\r\nimport Card from \"../Card\";\r\n\r\nimport IList from \"./index.interface\";\r\n\r\nimport \"./style.scss\";\r\n\r\nconst List = (props: IList) => (\r\n  <div className=\"aviasales-list-tickets\">\r\n    {props.tickets.map((ticket) => (\r\n      <Card {...ticket} key={`${ticket.price + Math.random()}-${ticket.carrier}`} />\r\n    ))}\r\n  </div>\r\n);\r\n\r\nexport default List;\r\n","import React from \"react\";\r\nimport { Typography } from \"antd\";\r\n\r\nconst { Title } = Typography;\r\n\r\nconst HeaderMain = () => (\r\n  <header className=\"aviasales-header\">\r\n    <Title italic={true} mark={true}>\r\n      Aviasales\r\n    </Title>\r\n  </header>\r\n);\r\n\r\nexport default HeaderMain;\r\n","import React from \"react\";\r\nimport { Button } from \"antd\";\r\n\r\nimport { IButton } from \"./index.interface\";\r\n\r\nconst ButtonMain = (props: IButton) => {\r\n  return (\r\n    <Button type={props.type} size={props.size} onClick={props.onClickHandler}>\r\n      {props.label}\r\n    </Button>\r\n  );\r\n};\r\n\r\nexport default ButtonMain;\r\n","import { IResponseTickets, ISearchId } from \"../index.interface\";\r\n\r\nconst PATH_GET_SEARCH_ID = \"https://front-test.beta.aviasales.ru/search\";\r\nconst PATH_GET_TICKETS = \"https://front-test.beta.aviasales.ru/tickets\";\r\n\r\nexport const getSearchId = async () => {\r\n  const data = await fetch(PATH_GET_SEARCH_ID);\r\n  const response: ISearchId = await data.json();\r\n\r\n  return response;\r\n};\r\n\r\nexport const getTickets = async (searchId: string) => {\r\n  let status: boolean = true;\r\n\r\n  while (status) {\r\n    try {\r\n      const data = await fetch(`${PATH_GET_TICKETS}?searchId=${searchId}`);\r\n  \r\n      if (data.status >= 200 && data.status <= 299) {\r\n        const response: IResponseTickets = await data.json();\r\n        return response;\r\n      } else {\r\n        status = false;\r\n        throw new Error(\"Что-то пошло не так\");\r\n      }\r\n    } catch (error) {\r\n      status = true;\r\n      console.log(\"---data\", error);\r\n    }\r\n  }\r\n};\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { message, Spin, Tabs, Empty, Typography, Space, PageHeader } from \"antd\";\r\nimport { get } from \"lodash\";\r\n\r\nimport Filter from \"./components/Filter\";\r\nimport List from \"./components/List\";\r\nimport HeaderMain from \"./components/Header\";\r\nimport ButtonMain from \"./components/Button\";\r\n\r\nimport { getSearchId, getTickets } from \"./query\";\r\nimport { filteringTickets } from \"./utils\";\r\n\r\nimport \"./style.scss\";\r\n\r\nimport { SORT, TABS, STOPS, LIMIT, FILTERS } from \"./constants\";\r\n\r\nimport ICard from \"./components/Card/index.interface\";\r\nimport { ITickets } from \"./index.interface\";\r\n\r\nconst { Text } = Typography;\r\nconst { TabPane } = Tabs;\r\n\r\nconst Aviasales = () => {\r\n  const [searchId, setSearchId] = useState<string>(\"\");\r\n  const [ticketsAll, setTicketsAll] = useState<ICard[]>([]);\r\n  const [endSearchTickets, setEndSearchTickets] = useState<boolean>(false);\r\n  const [firstPackTickets, setFirstPackTickets] = useState<boolean>(true);\r\n\r\n  const [defaultFilter, setDefaultFilter] = useState<string>(SORT.CHEAP);\r\n  const [sortTickets, setSortTickets] = useState<ITickets>({\r\n    tickets: [],\r\n    viewTickets: []\r\n  });\r\n  const [stops, setStops] = useState<Array<string>>(Object.keys(STOPS));\r\n\r\n  useEffect(() => {\r\n    getSearchId()\r\n      .then((response) => setSearchId(response.searchId))\r\n      .catch(() =>\r\n        message.warning(\"Что-то пошло не так, перезагрузите страницу\")\r\n      );\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (searchId === \"\") {\r\n      return;\r\n    }\r\n\r\n    if (!endSearchTickets) {\r\n      getTickets(searchId)\r\n        .then((response) => {\r\n          setEndSearchTickets(get(response, \"stop\", false));\r\n          setTicketsAll([...ticketsAll, ...get(response, \"tickets\", [])]);\r\n        \r\n          if (firstPackTickets) {\r\n            const list = filteringTickets(ticketsAll, defaultFilter, stops);\r\n\r\n            setSortTickets({\r\n              tickets: list,\r\n              viewTickets: list.slice().splice(0, LIMIT)\r\n            });\r\n          }\r\n\r\n          setFirstPackTickets(false);\r\n        });\r\n    }\r\n  }, [endSearchTickets, searchId, ticketsAll]);\r\n\r\n  useEffect(() => {\r\n    if (endSearchTickets) {\r\n      const list = filteringTickets(ticketsAll, defaultFilter, stops);\r\n\r\n      setSortTickets({\r\n        tickets: list,\r\n        viewTickets: list.slice().splice(0, LIMIT)\r\n      });\r\n    }\r\n  }, [ endSearchTickets, ticketsAll, defaultFilter, stops ]);\r\n\r\n  const onChangeTabs = (key: string): void => {\r\n    const list = filteringTickets(ticketsAll, key, stops);\r\n    setDefaultFilter(key);\r\n\r\n    setSortTickets(() => ({\r\n      tickets: list,\r\n      viewTickets: list.slice().splice(0, LIMIT)\r\n    }));\r\n  };\r\n\r\n  const onLoadTickets = (): void => {\r\n    setSortTickets({\r\n      tickets: sortTickets.tickets,\r\n      viewTickets: [ ...sortTickets.viewTickets, ...sortTickets.tickets.slice().splice(sortTickets.viewTickets.length, LIMIT) ]\r\n    });\r\n  }\r\n\r\n  return (\r\n    <section className=\"aviasales\">\r\n      <PageHeader title=\"Back\" onBack={() => window.history.back()} />\r\n      <HeaderMain />\r\n      <div className=\"aviasales__wrapper\">\r\n        <aside className=\"aviasales__filters\">\r\n          { FILTERS.map((item) => <Filter title={item.title} items={item.items} clickFilterHandler={setStops} />) }\r\n        </aside>\r\n        <div className=\"aviasales__content\">  \r\n          <Tabs defaultActiveKey={defaultFilter} onChange={onChangeTabs}>\r\n            {TABS.map((tab) => (\r\n              <TabPane tab={tab.title} key={tab.key}>\r\n                <Space direction=\"vertical\">\r\n                  <Text>{`Мы нашли ${ticketsAll.length} билетов`}</Text>\r\n                  <Text>{`Мы нашли ${sortTickets.tickets.length} билетов по выбраным фильтрам`}</Text>\r\n                  <Text>{`Показано ${sortTickets.viewTickets.length} из ${sortTickets.tickets.length} билетов`}</Text>\r\n                  { !endSearchTickets && <Spin />  }\r\n                </Space>\r\n                { stops.length === 0 && <Empty description={`Мы нашли ${sortTickets.tickets.length} билетов по выбраным фильтрам`} /> }\r\n                { sortTickets.tickets.length > 0 && (\r\n                  <>\r\n                    <List tickets={sortTickets.viewTickets} />\r\n                    <ButtonMain type=\"primary\" size=\"large\" onClickHandler={onLoadTickets} label={`Показать ещё ${LIMIT} билетов`} />\r\n                  </>\r\n                  )\r\n                }\r\n              </TabPane>\r\n            ))}\r\n          </Tabs>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Aviasales;\r\n"],"names":["STOPS","Title","Typography","Group","Checkbox","props","useState","checkAll","setCheckAll","items","checkedList","setCheckedList","onChange","useCallback","list","length","clickFilterHandler","countStops","listStops","Object","entries","stop","key","value","includes","push","searchStops","onCheckAllChange","event","target","checked","className","level","title","options","SORT","TABS","FILTERS","values","sumDurationStops","ticket","reduce","acc","item","duration","filteringTickets","tickets","parameter","stops","sort","a","b","price","segments","filter","from","to","filterOfTransfers","range","date","milisecondStartDate","Date","parse","milisecondDuration","dtStart","dtFinish","getHours","getMinutes","formatTime","days","hours","Math","floor","minutes","ceil","stopsCount","count","message","toUpperCase","origin","destination","join","src","carrier","alt","map","random","italic","mark","type","size","onClick","onClickHandler","label","getSearchId","fetch","data","json","response","getTickets","searchId","status","Error","console","log","Text","TabPane","Tabs","setSearchId","ticketsAll","setTicketsAll","endSearchTickets","setEndSearchTickets","firstPackTickets","setFirstPackTickets","defaultFilter","setDefaultFilter","viewTickets","sortTickets","setSortTickets","keys","setStops","useEffect","then","catch","get","slice","splice","onLoadTickets","onBack","window","history","back","Header","defaultActiveKey","tab","direction","description","Button"],"sourceRoot":""}